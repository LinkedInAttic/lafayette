Lafayette
=========

Lafayette is a system to store various email abuse reports sent in ARF. It is organized in such a way that fraudulent emails can be easily selected, sorted and reported back to the resource owners. For instance it can be used to receive DMARC failure reports.

How to install
==============

This requires python, flask and mysql server.

1) create the database using the forensic.sql file
2) run the web server forensic.py
3) install in a cron job the script forensic-mysql.py
4) send failure reports to the appropriate mailbox that forensic-mysql.py will read

Quick Guide
===========

To detect fraudulent emails is a combination of an automatic process, and manual one. The DMARC failure reports indicate a non authenticated email, sometimes it is a bounce (people forget to sign their bounces), sometimes it is an auto-reply. So the system tries to classify each email so that so we can ignore such reports. A cursory look of the rest of the failure reports allows to identify patterns. For instance "all emails in the last 2 days with the subject containing 'wire transfer'" or "all emails in the last 2 days which contain an URL that terminates by mail.htm". Once te emails identified they can be selected to be reported to the abuse email address of the network owner of the original sending IP.

Lafayette collects, identifies and reports fraudulent emails, so the zombies get fixed and removed from the botnet they belong to, also the URLs are added in blocking lists that browsers use.